<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Money Train Tap Game</title>
<style>
  body { font-family: Arial, sans-serif; background:#111; color:#fff; text-align:center; padding:20px; }
  #mathSection, #tapSection, #resultSection { margin-top:20px; }

  #trainBarContainer {
    width: 90%; 
    height: 20px; 
    background: #333; 
    margin: 20px auto;
    border-radius: 10px;
    overflow: hidden;
    display:none;
  }

  #trainBar {
    height: 100%;
    width: 100%;
    background: linear-gradient(to right, gold, orange);
    transition: width 0.2s linear;
  }

  #tapBtn {
    padding: 20px 40px;
    font-size: 24px;
    background: #ff0066;
    border:none;
    border-radius: 12px;
    color:white;
    display:none;
  }

</style>
</head>
<body>

<h2>ğŸ”¥ Money Train Tap Game</h2>

<!-- ---------- 1. MATH SECTION ---------- -->
<div id="mathSection">
  <h3>Solve this to enter ğŸ‘‡</h3>
  <div id="mathQuestion" style="font-size:26px; margin:10px;"></div>
  <input id="mathAnswer" placeholder="your answer" style="padding:10px; font-size:18px;">
  <button onclick="checkMath()" style="padding:10px 20px; font-size:18px;">Submit</button>
  <p id="mathError" style="color:red;"></p>
</div>

<!-- ---------- 2. TAP GAME SECTION ---------- -->
<div id="tapSection">

  <div id="trainBarContainer">
      <div id="trainBar"></div>
  </div>

  <button id="tapBtn">TAP FAST! ğŸ”¥</button>

  <h3 id="tapCount" style="display:none; margin-top:20px;">Taps: 0</h3>

</div>

<!-- ---------- 3. RESULTS SECTION ---------- -->
<div id="resultSection" style="display:none;">
  <h2>â³ Time's Up!</h2>
  <p id="finalTaps" style="font-size:28px;"></p>
  <p id="finalPosition" style="font-size:22px; color:gold;"></p>
</div>

<script>

// ========================
// 1. RANDOM MATH QUESTION
// ========================
let correctAnswer;

function generateMath() {
  let a = Math.floor(Math.random()*10)+1;
  let b = Math.floor(Math.random()*10)+1;
  correctAnswer = a + b;

  document.getElementById("mathQuestion").textContent = `${a} + ${b} = ?`;
}
generateMath();

function checkMath() {
  let userAnswer = parseInt(document.getElementById("mathAnswer").value.trim());

  if (userAnswer === correctAnswer) {
    document.getElementById("mathSection").style.display = "none";
    startTapStage();
  } else {
    document.getElementById("mathError").textContent = "Wrong answer â€” try again!";
  }
}


// ========================
// 2. TAP GAME LOGIC
// ========================
let taps = 0;
let timeLimit = 5000; // 5 seconds
let timerRunning = false;

function startTapStage() {
  document.getElementById("tapBtn").style.display = "inline-block";
  document.getElementById("tapCount").style.display = "block";
  document.getElementById("trainBarContainer").style.display = "block";

  startTrainTimer();

  document.getElementById("tapBtn").addEventListener("click", () => {
    if (!timerRunning) return;
    taps++;
    document.getElementById("tapCount").textContent = "Taps: " + taps;
  });
}

function startTrainTimer() {
  timerRunning = true;
  let bar = document.getElementById("trainBar");
  let start = Date.now();

  let interval = setInterval(() => {
    let elapsed = Date.now() - start;
    let percent = Math.max(0, 100 - (elapsed / timeLimit * 100));
    bar.style.width = percent + "%";

    if (elapsed >= timeLimit) {
      clearInterval(interval);
      stopGame();
    }

  }, 50);
}


// ========================
// 3. END GAME + POSITION
// ========================
function stopGame() {
  timerRunning = false;
  document.getElementById("tapBtn").disabled = true;

  document.getElementById("resultSection")..style.display = "block";
  document.getElementById("finalTaps").textContent = `You got ${taps} taps!`;

  // Fake leaderboard (replace with Firebase later)
  let leaderboard = [150, 132, 120, 110, 90, 80, 60, 40, 30, 20];

  // Insert player taps
  leaderboard.push(taps);

  // Sort descending
  leaderboard.sort((a,b) => b - a);

  // Find player position
  let position = leaderboard.indexOf(taps) + 1;

  document.getElementById("finalPosition").textContent =
    `Your position: #${position} ğŸ`;

}

</script>


</body>
</html>